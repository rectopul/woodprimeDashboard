const URL="http://192.168.0.10";function update(e,t){var o=document.querySelector(".barload");t&&"dark"==t?o.classList.add("dark"):o.classList.remove("dark");var n=1;if("function"==typeof e){n=33;var r=setInterval(a,14);function a(){n>=100?(n=1,o.style.width="0%",e(),clearInterval(r)):(n++,o.style.width=n+"%")}}if("number"==typeof e&&2===e){n=33;r=setInterval(a,14);function a(){if(65===n)return clearInterval(r);n++,o.style.width=n+"%"}}if("number"==typeof e&&1===e){n=1;r=setInterval(a,7);function a(){if(33===n)return clearInterval(r);n++,o.style.width=n+"%"}}}const util={request:e=>new Promise((t,o)=>{const{headers:n,body:r,method:a,url:s}=e;var c=new Headers;n["content-type"]&&c.append("Content-Type",n["content-type"]);var d={method:a||"GET",headers:c};r&&(d.body=JSON.stringify(r));var i=new Request(s,d);fetch(i).then(e=>e.json()).then(e=>t(e)).catch(e=>o(e))})},spinner=(e,t)=>{const o=document.createElement("div");return o.classList.add("spinner-border",`text-${e||"primary"}`),t&&"small"===t&&o.classList.add("spinner-border-sm"),o.setAttribute("role","status"),o.innerHTML='<span class="sr-only">Loading...</span>',o},animateCSS=async(e,t,o="animate__")=>new Promise((n,r)=>{const a=`${o}${t}`,s=e;s.classList.add(`${o}animated`,a),s.addEventListener("animationend",function e(){s.classList.remove(`${o}animated`,a),s.removeEventListener("animationend",e),n("Animation ended")})});$(document).ready(function(){$(".dropdown-toggle").dropdown(),$('[data-toggle="tooltip"]').tooltip()}),window.addEventListener("load",function(){var e=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(e,function(e){e.addEventListener("submit",function(t){!1===e.checkValidity()&&(t.preventDefault(),t.stopPropagation()),e.classList.add("was-validated")},!1)})},!1);const btnInsertCustom=document.querySelector(".btn-insert-custom"),custonResource="custon",custom=(()=>{const e={types:[],custons:[],options:[],childs:[]},t=document.querySelector(".optionsSelected"),o=(e,t)=>{const{id:o,name:a}=e,s=document.createElement("div");return s.classList.add("col-md-3",`${"type"===t?"typeSelected":"customSelected"}-${o}`),s.dataset.id=o,s.innerHTML=`\n      <div class="card">\n         <div class="card-header">\n            All ${"type"===t?"Type":"Custom"}\n         </div>\n\n         <div class="card-body">\n            <h3>${a}</h3>\n         </div>\n\n         <div class="card-footer text-muted">\n            <button class="btn btn-primary" data-id="${o}"><i class="far fa-trash-alt"></i></button>\n         </div>\n      </div>\n      `,"type"==t?r(s.querySelector("button")):n(s.querySelector("button")),s},n=t=>{t.addEventListener("click",o=>{o.preventDefault();const n=t.dataset.id,r=document.querySelector(`.listCustomByType div[data-id="${n}"] .selectAllCustom`);e.custons.splice(e.custons.indexOf(n),1),t.closest(`.customSelected-${n}`).remove(),r.checked=!1})},r=t=>{t.addEventListener("click",o=>{o.preventDefault();const n=t.dataset.id,r=document.querySelector(`.productType[data-id="${n}"] .selectAllType`);e.types.splice(e.types.indexOf(n),1),t.closest(`.typeSelected-${n}`).remove(),r.checked=!1})},a=t=>{t.addEventListener("click",o=>{o.preventDefault();const n=t.dataset.id;e.options.splice(e.options.indexOf(n),1),t.closest(`.optionSelected-${n}`).remove()})},s=o=>{o.addEventListener("click",n=>{const r=o.dataset.id,s=o.querySelector("h5").textContent,c=document.querySelector(".listOptionstoSelect > .active");c.classList.add("selected"),o.classList.toggle("show"),o.classList.contains("show")?(e.options.push(r),console.log(e),t&&t.append((e=>{const{name:t,id:o}=e,n=document.createElement("div");n.classList.add("col-md-3",`optionSelected-${o}`),n.dataset.id=o,n.innerHTML=`\n      <div class="card">\n         <div class="card-header">\n            Option\n         </div>\n\n         <div class="card-body">\n            <h6>${t}</h6>\n         </div>\n\n         <div class="card-footer text-muted">\n            <button class="btn btn-primary" data-id="${o}">\n               <i class="far fa-trash-alt" aria-hidden="true"></i>\n            </button>\n         </div>\n      </div>\n      `;const r=n.querySelector("button");return a(r),n})({id:r,name:s}))):(e.options.splice(e.options.indexOf(r),1),console.log(e),o.closest(".listCustomByType").querySelector(".show")||c.classList.remove("selected"),t&&t.querySelector(`.optionSelected-${r}`).remove())})},c=e=>{e.addEventListener("click",t=>{t.preventDefault();const o=document.querySelector(".actionConfirm"),n=document.querySelector(".aceptAction");o.value="customDestroy",n.dataset.id=e.dataset.id,$(".modalActionConfirm").modal("show"),n.addEventListener("click",t=>{const r=n.dataset.id;if("customDestroy"==o.value)return(e=>new Promise((t,o)=>{update(1,"dark"),fetch(`/api/custon/${e}`,{method:"DELETE",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>(update(2,"dark"),0===e?o("Customização não existe"):t("Customização excluída com sucesso!"))).catch(e=>o("Erro ao excluir customização"))}))(r).then(t=>update(()=>{e.closest(".col-3").remove();const o=document.querySelector(`.productCustonsBody .product-option-${r}`);return o&&o.remove(),Swal.fire({title:t,icon:"success",showCloseButton:!0})},"dark")).catch(e=>update(()=>{Swal.fire({title:e,icon:"error",showCloseButton:!0})},"dark"))})})},d=e=>{const t=document.createElement("div"),{id:o,name:n,description:r,type:a}=e;t.classList.add("col-3",`card-custom-${o}`),t.dataset.category=`type-${a}`,t.dataset.id=o,t.innerHTML=`\n       <div class="card border-primary mb-3 cardCustom" data-id="${o}">\n            <div class="card-header">\n               ${n}\n               <button type="button" \n                  class="btn btn-danger btn-sm btnDeleteCustom" \n                  data-id="${o}"\n               >\n                  <i class="fas fa-trash-alt"></i>\n               </button>\n            </div>\n           <div class="card-body text-primary">\n               <p class="card-text">${r}</p>\n               <button type="button"\n                  class="btn btn-primary btnShowOptionsCustom"\n                  data-custom="${o}"\n                  data-toggle="tooltip"\n                  data-placement="top"\n                  title="Visualizar opções"\n               >\n                  <i class="far fa-eye"></i>\n               </button>\n           </div>\n       </div>`;const s=t.querySelector(".btnDeleteCustom");return c(s),t},i=e=>e.addEventListener("click",t=>(t.preventDefault(),$("#options").modal("show"),document.querySelector(".optionsContainer").innerHTML='\n         <div class="spinner-border text-primary" role="status">\n            <span class="sr-only">Loading...</span>\n         </div>',document.querySelector(".modal.options .modal-title").innerHTML='\n         <div class="spinner-border text-primary" role="status">\n            <span class="sr-only">Loading...</span>\n         </div>',document.querySelector(".modal.formOptions .modal-title").innerHTML='\n         <div class="spinner-border text-primary" role="status">\n            <span class="sr-only">Loading...</span>\n         </div>',document.querySelector(".insertOption").dataset.option=e.dataset.custom,showOptions(e.dataset.custom))),l=e=>{const{id:t,name:o,description:n,type:r}=e,a=d(e);return document.querySelector(".container-types").prepend(a),$(a.querySelector(".btnShowOptionsCustom")).tooltip(),i(a.querySelector(".btnShowOptionsCustom"))},u=e=>{e.addEventListener("click",async t=>{t.preventDefault(),update(1,"dark");try{const t=e.dataset.id,o=document.querySelector(".listCustomByType");if(o.innerHTML="",!t)return console.log("Nenhum id selecionado");const n=await util.request({url:`/api/custon/option/${t}`,headers:{"content-type":"application/json"}});return update(()=>{const{options:t}=n;if(!t.length)return o.innerHTML="Nenhuma opção disponível";o.innerHTML="",t.map(e=>o.append(m(e))),$("#productCustonsNv1").modal("show"),$("#productCustonsNv1").on("hidden.bs.modal",function(t){e.closest(".col-md-3.mb-3").classList.remove("active"),$(this).off("hidden.bs.modal")}),e.closest(".col-md-3.mb-3").classList.add("active")},"dark")}catch(e){}})},m=t=>{const{id:o,name:n,image:r}=t,a=document.createElement("div");return a.classList.add("col-md-3"),-1!=e.options.indexOf(`${o}`)&&a.classList.add("show"),a.dataset.id=t.id,a.innerHTML=`\n      <div class="card border-primary mb-3 cardOption" data-id="${o}">\n         <div class="card-header">\n            <h5>${n}</h5>\n         </div>\n         <div class="card-body text-primary">\n            <p class="card-text">\n               <img src="${r}" class="img-thumbnail">\n            </p>\n         </div>\n      </div>\n      `,s(a),a},p=n=>{const r=document.createElement("div");r.classList.add("col-md-4"),r.dataset.id=n.id;const a=-1!=e.custons.indexOf(`${n.id}`)?"checked":"";r.innerHTML=`\n      <div class="card border-primary mb-3">\n\n         <div class="card-header d-flex justify-content-between align-items-center">\n         Selecionar Todos\n         <input type="checkbox" class="ml-auto selectAllCustom" id="selectAllCustom" value="${n.id}" ${a}>\n         </div>\n\n         <div class="card-body text-primary text-center customNv1Item" data-id="${n.id}" data-dismiss="modal">\n         <h6>${n.name}</h6>\n         </div>\n      </div>\n      `,(n=>{n.addEventListener("change",r=>{const a=n.value,s=n.closest(".card").querySelector("h6").textContent,c=n.closest(".col-md-4");1==n.checked?(e.custons.push(a),c.classList.add("selected"),t.append(o({id:a,name:s},"custom"))):(e.custons.splice(e.custons.indexOf(a),1),c.classList.remove("selected"),t.querySelector(`.customSelected-${a}`).remove())})})(r.querySelector(".selectAllCustom"));const s=r.querySelector(".customNv1Item");return u(s),r};return{selectCustom:function(t){return e.custons.push(parseInt(t))},removeCustom:function(t){const o=e.custons.filter(e=>e!=t);return e.custons=o},create:()=>{const e=document.querySelector(".typeCustom"),t=document.querySelector(".nameCustom"),o=document.querySelector(".descCustom");return(e=>new Promise((t,o)=>{e.map(e=>{const{input:n,msg:r}=e;return n.value?t():(n.setCustomValidity(r),n.reportValidity(),o(r))})}))([{input:e,msg:"Informe o nome da customização"},{input:t,msg:"Informe uma descrição para a customização"},{input:o,msg:"Selecione o tipo de customização"}]).then(n=>(document.querySelector(".loaderInsertCustom").classList.add("show"),(e=>new Promise((t,o)=>{const{name:n,description:r,type_id:a}=e;update(1,"dark"),fetch("/api/custon",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:n,description:r,type_id:a})}).then(e=>e.ok?e.json():o("Não foi possível cadastrar a customização")).then(e=>t(e)).catch(e=>(console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})})))}))({name:t.value,description:o.value,type_id:e.value}).then(n=>{const{name:r,description:a,id:s}=n;return update(()=>(Swal.fire({title:`Customização ${n.name} cadastrada`,icon:"success",showCloseButton:!0}),(e=>{const{id:t,name:o,type:n,type_id:r,description:a}=e,s=document.createElement("div");s.classList.add("col-4","productOption",`product-option-${t}`),s.dataset.customName=n.name||null,s.dataset.custom=t,s.dataset.id=t,s.dataset.customName=s.innerHTML=`\n      <div class="card border-primary mb-3 productCustom item" data-dismiss="modal" data-option-id="32">\n         <div class="card-header productOptionName">\n               ${o}\n         </div>\n   \n         <div class="card-body text-primary productOptionDesc">\n            <p class="card-text">${a}</p>\n         </div>\n      </div>`;const c=s.querySelector(".card");clickCustom(c),document.querySelector(".productCustonsBody").append(s)})(n),document.querySelector(".btn-modal-types").classList.remove("btn-success"),document.querySelector(".btn-modal-types").classList.add("btn-primary"),document.querySelector(".btn-modal-types").innerHTML="Items",console.log(e.value),l({name:r,description:a,id:s,type:e.value}),e.value="",t.value="",o.value="",document.querySelector(".loaderInsertCustom").classList.remove("show")),"dark")}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0})))).catch(e=>console.log(e))},destroy:c,showOptions:i,createCard:d,cardCustom:l,handleResetForm:()=>{const e=document.querySelectorAll(".informationProduct .form-row"),t=document.querySelectorAll(".subProducts > div");t&&Array.from(t).forEach(e=>e.remove()),e&&Array.from(e).forEach(e=>e.remove())},changeLevel:e=>{e.addEventListener("click",async t=>{t.preventDefault();try{const t=e.dataset.id,o=document.querySelector(".listCustomByType");if(o.innerHTML="",$("#productCustons").on("hidden.bs.modal",function(e){$("#productCustonsNv1").modal("show"),$(this).off("hidden.bs.modal")}),!t)return Swal.fire({title:"Nenhum id Selecionado",icon:"error",showCloseButton:!0});const n=await util.request({url:`/api/type/${t}`,headers:{"content-type":"application/json"}}),{customization:r}=n;if(!r.length)return o.innerHTML="Nenhuma customisação deste tipo";r.map(e=>{o.append(p(e))})}catch(e){}})},closeCustom:e=>{e.addEventListener("click",function(e){e.preventDefault(),$("#productCustonsNv1").on("hidden.bs.modal",function(e){$(this).off("hidden.bs.modal")})})},allTypes:n=>{n.addEventListener("change",r=>{const a=n.value,s=n.closest(".productType").querySelector("h3").textContent,c=n.closest(".productType");1==n.checked?(e.types.push(a),c.classList.add("selected"),t.append(o({id:a,name:s},"type"))):(e.types.splice(e.types.indexOf(a),1),c.classList.remove("selected"),t.querySelector(`.typeSelected-${a}`).remove())})},getExcludes:()=>e,getOptions:u,handleChild:({name:t,description:o,image:n})=>e.childs.push({name:t,description:o,image:n}),handleChildForm:e=>{const{name:t,id:o,nameProduct:n}=e,r=document.createElement("div");return r.classList.add("form-row"),r.innerHTML=`\n         \n         <div class="form-group col-12 mt-4">\n            <hr>\n            <label for="descriptionChildren-${o}">Descrição ${t}</label>\n            <textarea class="form-control" id="descriptionChildren-${o}" rows="3" placeholder="Informe uma descrição" required></textarea>\n            <input type="hidden" id="nameChildren-${o}" value="${n} - ${t}" required>\n            <input type="hidden" id="codeChildren-${o}" value="${o}" required>\n         </div>\n         <div class="form-group col-12">\n            <label for="imageChildren-${o}">Imagem ${t}</label>\n            <input type="text" class="form-control" id="imageChildren-${o}" placeholder="https://www.image.com" required>\n         </div>\n       `,r}}})(),btnGetOptions=document.querySelectorAll(".listOptionstoSelect > div a.btn");btnGetOptions&&Array.from(btnGetOptions).forEach(e=>custom.getOptions(e));const allTypes=document.querySelectorAll(".selectAllType");allTypes&&Array.from(allTypes).forEach(e=>custom.allTypes(e));const btnCloseCustom=document.querySelector(".closeCustom");btnCloseCustom&&custom.closeCustom(btnCloseCustom);const typesCustom=document.querySelectorAll(".typeCustomItem");typesCustom&&Array.from(typesCustom).forEach(e=>custom.changeLevel(e)),btnInsertCustom.addEventListener("click",e=>(e.preventDefault(),custom.create()));const cardCustom=document.querySelectorAll(".btnShowOptionsCustom");Array.from(cardCustom).forEach(e=>custom.showOptions(e));const openFormOption=document.querySelector(".insertOption");openFormOption.addEventListener("click",function(e){e.preventDefault(),$("#options").on("hidden.bs.modal",function(e){$("#formOptions").modal("show"),$(this).off("hidden.bs.modal")}),$("#formOptions").on("hidden.bs.modal",function(e){$("#options").modal("show")})});const controller=new AbortController,signal=controller.signal,indexCustom=()=>{fetch("/api/custon",{method:"GET",headers:{"content-type":"application/json"},signal:signal}).then(e=>e.json()).then(e=>{e.length>0&&update(()=>e.length?(document.querySelector(".container-types").innerHTML="",e.forEach(e=>{if(e.type_id){const t=custom.createCard({name:e.name,description:e.description,id:e.id,type:e.type_id});document.querySelector(".container-types").append(t)}})):document.querySelector(".container-types").innerHTML="Nenhum registro encontrado","dark")}).catch(e=>{"AbortError"===e.name&&console.log("abortado")})},findCustoms=e=>{fetch(`/api/custon/search/${e}`,{method:"GET",headers:{"content-type":"application/json"},signal:signal}).then(e=>e.json()).then(e=>{update(()=>e.length?(document.querySelector(".container-types").innerHTML="",e.forEach(e=>{custom.cardCustom({name:e.name,description:e.description,id:e.id,type:e.type_id})})):document.querySelector(".container-types").innerHTML="Nenhum registro encontrado","dark")}).catch(e=>{"AbortError"===e.name&&console.log("abortado")})},searchCustom=()=>{const e=document.querySelector(".search-custom"),t=document.querySelector(".customSearchButton"),o=document.querySelector(".formSearchCustom");t.addEventListener("click",function(t){t.preventDefault();const o=e.value;return o.length<3?(update(1,"dark"),void fetch("/api/custon",{method:"GET",headers:{"content-type":"application/json"},signal:signal}).then(e=>e.json()).then(e=>{e.length>0&&update(()=>e.length?(document.querySelector(".container-types").innerHTML="",e.forEach(e=>{if(e.type_id){const t=custom.createCard({name:e.name,description:e.description,id:e.id,type:e.type_id});document.querySelector(".container-types").append(t)}})):document.querySelector(".container-types").innerHTML="Nenhum registro encontrado","dark")}).catch(e=>{"AbortError"===e.name&&console.log("abortado")})):o.length>3?(update(1,"dark"),findCustoms(o)):void 0}),o.addEventListener("submit",function(t){t.preventDefault();const o=e.value;if(o.length>3)return update(1,"dark"),findCustoms(o)})};searchCustom();const filter=()=>{const e=document.querySelectorAll(".filtersCustom > a");Array.from(e).forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const o=e.dataset.filter,n=document.querySelectorAll(".container-types > div");document.querySelectorAll(`.container-types > div[data-category="${o}"]`);if("type-all"==o)return Array.from(n).forEach(e=>{e.classList.remove("hide")}),Array.from(n).forEach(e=>animateCSS(e,"fadeIn"));let r=[],a=[];Array.from(n).forEach(e=>{return e.dataset.category!=o?a.push(e):r.push(e)}),async function(){await Array.from(a).forEach(async e=>await animateCSS(e,"bounceOut").then(()=>e.classList.add("hide"))),await Array.from(r).forEach(async e=>(e.classList.remove("hide"),await animateCSS(e,"fadeIn")))}()})})};filter();const btnDestroyCustom=document.querySelectorAll(".btnDeleteCustom");Array.from(btnDestroyCustom).forEach(e=>custom.destroy(e));const insertUser=e=>new Promise((t,o)=>{const{name:n,email:r,password:a}=e;update(1,"dark"),fetch("/api/user",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:n,email:r,password:a})}).then(e=>e.json()).then(e=>e.error?o("Erro ao inserir novo usuário"):(update(2,"dark"),t(e))).catch(e=>o(e))}),formNewUser=e=>{e.addEventListener("click",e=>{e.preventDefault();const t=document.querySelector(".newUserName"),o=document.querySelector(".newUserMail"),n=document.querySelector(".newUserPassword"),r=t.value,a=o.value,s=n.value;return console.log({name:r,email:a,password:s}),r?a?s?void insertUser({name:r,email:a,password:s}).then(e=>{const{success:t}=e;return update(()=>{const e=document.createElement("tr");return e.innerHTML=`\n                <th scope="row">${t.id}</th>\n                <td>${t.name}</td>\n                <td>${t.email}</td>\n                <td class="td-actions text-right">\n                    <button type="button" class="btn btn-danger btnRemoveUser" data-id="${t.id}">\n                        <i class="far fa-trash-alt" aria-hidden="true"></i> Excluir\n                    </button>\n                </td>\n                `,document.querySelector(".listUserInSistem").append(e),clickToDestroyUser(e.querySelector(".btnRemoveUser")),$("#newUser").modal("hide"),$("#newUser").on("hidden.bs.modal",function(e){return Swal.fire({title:`Usuário ${t.name} criado com sucesso!`,icon:"success",showCloseButton:!0}),document.querySelector(".modal-backdrop").remove()})},"dark")}).catch(e=>{update(()=>Swal.fire({title:e,icon:"error",showCloseButton:!0}),"dark")}):(n.setCustomValidity("Informe uma senha para o usuário"),n.reportValidity()):(o.setCustomValidity("Informe o e-mail do usuário"),o.reportValidity()):(t.setCustomValidity("Informe o nome do usuário"),t.reportValidity())})},formInsertNewUser=document.querySelector(".btnInsertNewUser");formNewUser(formInsertNewUser);const destroyUser=e=>new Promise((t,o)=>{update(1,"dark"),fetch(`/api/user/${e}`,{method:"DELETE",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>e.error?o("Erro ao inserir novo usuário"):(update(2,"dark"),t(e))).catch(e=>o(e))}),clickToDestroyUser=e=>{e.addEventListener("click",function(t){const o=e.dataset.id;return destroyUser(o).then(()=>(e.closest("tr").remove(),update(()=>{Swal.fire({title:"Usuário deletado com sucesso!",icon:"success",showCloseButton:!0})},"dark"))).catch(e=>update(()=>{Swal.fire({title:"Erro ao deletar usuário!",icon:"error",showCloseButton:!0})},"dark"))})},btnsRemoveUser=document.querySelectorAll(".btnRemoveUser");Array.from(btnsRemoveUser).forEach(e=>clickToDestroyUser(e));const user={changePassword:e=>{e.addEventListener("submit",t=>{if(t.preventDefault(),e.checkValidity()){const t=e.dataset.id,o=e.querySelector(".newPassword").value;update(1,"dark"),util.request({method:"PUT",url:`/api/user/${t}`,headers:{"content-type":"application/json"},body:{password:o}}).then(e=>update(()=>{$("#changePasswordModal").modal("hide"),$("#changePasswordModal").on("hidden.bs.modal",function(e){return document.querySelector(".modal-backdrop")&&document.querySelector(".modal-backdrop").remove(),Swal.fire({title:"Senha atualizada",icon:"success",showCloseButton:!0})})},"dark"))}})}},formChangePassword=document.querySelector(".formChangePassword");formChangePassword&&user.changePassword(formChangePassword);const optionResource="option",editCard=e=>{const{id:t,name:o,price:n,image:r}=e,a=document.querySelector(`.cardOption[data-id="${t}"]`);a.querySelector(".optionTitle").innerHTML=o,a.querySelector(".card-body img").src=r;const s=Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n);return a.querySelector(".priceOption").innerHTML=s},cancelSaveOption=document.querySelectorAll(".cancelSaveOption, .formOptions .close");Array.from(cancelSaveOption).forEach(e=>{e.addEventListener("click",e=>{const t=document.querySelector(".formOptions");t.querySelector(".saveOption").dataset.editId="",t.querySelector(".optionName").value="",t.querySelector(".optionImage").value=""})});const setFormEditOption=(e,t)=>{const{name:o,price:n,image:r}=t,a=document.querySelector(".formOptions");a.classList.add("edit"),a.querySelector(".optionName").value=o,a.querySelector(".optionImage").value=r,a.querySelector(".saveOption").dataset.editId=e},updateOption=()=>{const e=document.querySelector(".formOptions");e.classList.add("edit");const t=e.querySelector(".optionName").value,o=e.querySelector(".optionImage").value,n=e.querySelector(".saveOption").dataset.editId;update(1),fetch(`/api/option/${n}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({name:t,image:o,price:price})}).then(r=>{update(()=>(e.querySelector(".saveOption").dataset.editId="",e.querySelector(".optionName").value="",e.querySelector(".optionImage").value="",editCard({id:n,name:t,image:o,price:price}),$("#formOptions").modal("hide"),$("#formOptions").on("hidden.bs.modal",function(e){$("#options").modal("show"),$(this).off("hidden.bs.modal")})))}).catch(e=>(console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})})))},clickUpdateOption=e=>{const t=e.dataset.id;e.addEventListener("click",o=>{const n=e.closest(".row").querySelector(".optionTitle").innerText.replace("\n",""),r=e.closest(".cardOption").querySelector(".card-text > img").src,a=parseFloat(e.closest(".cardOption").querySelector(".priceOption").innerText.replace("R$","").replace(",","."));document.querySelector(".insertOption");return o.preventDefault(),$("#options").on("hidden.bs.modal",function(e){$("#formOptions").modal("show"),$(this).off("hidden.bs.modal")}),$("#formOptions").on("hidden.bs.modal",function(e){$("#options").modal("show")}),setFormEditOption(t,{name:n,image:r,price:a})})},deleteOption=e=>{const t=e.dataset.id;update(1),fetch(`/api/option/${t}`,{method:"DELETE",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(t=>{update(()=>{e.closest(".option").remove()})}).catch(e=>(console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})})))},clickRemoveOption=e=>{e.addEventListener("click",t=>{t.preventDefault(),deleteOption(e)})},showOptions=e=>{update(1,"dark"),fetch(`/api/option?custom=${e}`).then(e=>e.json()).then(e=>{update(()=>{document.querySelector(".modal.options .modal-title").innerHTML=e.name,document.querySelector(".modal.formOptions .modal-title").innerHTML=`Adicionar ${e.name}`;const{options:t}=e;if(document.querySelector(".optionsContainer").innerHTML="",!t.length)return document.querySelector(".optionsContainer").innerHTML="Não há opções castradas para esta customização";t.forEach(e=>{let t=document.createElement("div");return t.classList.add("col-6","col-lg-4","option"),t.innerHTML=`\n                     <div class="card border-primary mb-3 cardOption" data-id="${e.id}">\n                        <div class="card-header">\n                            <div class="row">\n                                <div class="col-6 optionTitle">\n                                    ${e.name} \n                                </div>\n                                <div class="col-6 ml-auto">\n                                    <button class="btn btn-primary btn-sm editOption" data-dismiss="modal" data-id="${e.id}" type="submit">\n                                       <i class="fas fa-edit"></i>\n                                    </button>\n                                    \n                                    <button class="btn btn-danger btn-sm" data-id="${e.id}" type="submit">\n                                        <i class="far fa-trash-alt"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="card-body text-primary">\n                            <p class="card-text">\n                                <img src="${e.image}" class="img-thumbnail">\n                            </p>\n                        </div>\n                     </div>`,clickRemoveOption(t.querySelector(".card-header .btn-danger")),clickUpdateOption(t.querySelector(".card-header .editOption")),document.querySelector(".optionsContainer").append(t)})},"dark")}).catch(e=>(console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})})))},InsertOption=e=>{const t=document.querySelector(".optionName"),o=document.querySelector(".optionImage"),n=document.createElement("div");if(n.classList.add("col-6","col-lg-4","option"),!t.value)return t.setCustomValidity("Informe um nome para esta opção"),t.reportValidity();if(!o.value)return o.setCustomValidity("Informe a url da imagem"),o.reportValidity();const r={customization_id:e,name:t.value,image:o.value,price:0};document.querySelectorAll(".optionsContainer > div").length||(document.querySelector(".optionsContainer").innerHTML=""),update(1),fetch("/api/option",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(r)}).then(e=>e.json()).then(e=>{update(()=>(n.innerHTML=`\n                  <div class="card border-primary mb-3 cardOption" data-id="${e.id}">\n                        <div class="card-header">\n                            <div class="row">\n                                <div class="col-6 optionTitle">\n                                    ${e.name} \n                                </div>\n                                <div class="col-6 ml-auto">\n                                    <button class="btn btn-primary btn-sm editOption" data-dismiss="modal" data-id="${e.id}" type="submit">\n                                       <i class="fas fa-edit"></i>\n                                    </button>\n                                 \n                                    <button class="btn btn-danger btn-sm" data-id="${e.id}" type="submit">\n                                          <i class="far fa-trash-alt"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                          <div class="card-body text-primary">\n                              <p class="card-text">\n                                  <img src="${e.image}" class="img-thumbnail">\n                              </p>\n                          </div>\n                  </div>`,document.querySelector(".optionsContainer").prepend(n),clickRemoveOption(n.querySelector(".card-header .btn-danger")),clickUpdateOption(n.querySelector(".card-header .editOption")),$("#formOptions").modal("hide"),document.querySelector(".insertOption").dataset.insert=!1,$("#formOptions").on("hidden.bs.modal",function(e){$("#options").modal("show"),$(this).off("hidden.bs.modal")})))}).catch(e=>(update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})}),console.log(e)))},btnSaveOption=document.querySelector(".saveOption");btnSaveOption.addEventListener("click",e=>{if(e.preventDefault(),btnSaveOption.dataset.editId)return updateOption();InsertOption(document.querySelector(".insertOption").dataset.option)});const vtexAccountName="woodprime",vtexEnvironment="vtexcommercestable",searching=(()=>{const e=e=>{return e.map(e=>{const t=document.createElement("div");return t.classList.add("productInSearch","col-6","col-md-3","my-3"),t.dataset.id=e.id,t.innerHTML=`\n         <div class="card">\n            <img class="card-img-top" src="${e.image}" alt="Card image cap">\n            <div class="card-body">\n               <h5 class="card-title">${e.name}</h5>\n               <small>${e.customization?e.customization.name:""}</small>\n            </div>\n         </div>\n         `,(e=>{e.addEventListener("click",async t=>{try{t.preventDefault(),e.closest(".col-6.col-md-3").style.display="none";const o=e.dataset.id,r=e.closest(".productFind").dataset.id;await n({url:"/api/product_opt",method:"POST",headers:{"content-type":"application/json"},body:{option_id:o,product_id:r}}),e.closest(".col-6.col-md-3").remove()}catch(t){e.closest(".col-6.col-md-3").style.display="flex",console.log(t)}})})(t),t})},t=t=>{const{name:o,id:r,image:a,code:s,custom:c}=t,d=document.createElement("div");d.classList.add("col-12","productFind"),d.dataset.id=r,d.innerHTML=`\n      <div class="row">\n         <div class="col-md-4">\n         <img src="${a}" alt="" class="img-thumbnail" style="width: 100%">\n         </div>\n\n         <div class="col-md">\n            <h4>${o}</h4>\n\n            <p>${s}</p>\n         </div>\n\n         <div class="col-2 text-right">\n            <button type="button" class="btn btn-danger destrProduct" data-id="${r}">Deletar</button>\n         </div>\n      </div>\n\n      <hr>\n\n      <div class="row">\n         <h1 class="text-center mx-auto mb-4">Customizações</h1>\n         <div class="col-12 productCustoms">\n            <div class="row"></div>\n         </div>\n      </div>\n      `;const i=d.querySelector(".destrProduct");return i&&(e=>{e.addEventListener("click",async t=>{try{t.preventDefault(),e.closest(".productFind").style.display="none";const o=e.dataset.id;return await n({url:`/api/product/${o}`,method:"DELETE",headers:{"content-type":"application/json"}}),e.closest(".productFind").remove()}catch(t){e.closest(".productFind").style.display="flex",console.log(t)}})})(i),[...e(c)].map(e=>{d.querySelector(".productCustoms > .row").append(e)}),d},o=e=>{const{id:t,image:o,name:n}=e,a=document.createElement("div");return a.classList.add("col-12"),a.dataset.id=t,a.innerHTML=`\n      <div class="row">\n         <img src="${o}" alt="produto" width="40px" class="img-thumbnail">\n         \x3c!--name of product --\x3e\n         <span>${n}</span>\n      </div>\n      `,r(a),a},n=e=>new Promise((t,o)=>{const{url:n,headers:r,method:a,body:s}=e,c={method:a};r&&(c.headers=r),s&&(c.body=JSON.stringify(s)),fetch(n,c).then(e=>e.json()).then(e=>t(e)).catch(e=>o(e))}),r=e=>{const o=document.querySelector(".listProduct");e.addEventListener("click",async r=>{r.preventDefault();const a=e.dataset.id,s=await n({url:`/api/product/${a}`,method:"GET",headers:{"content-type":"application/json"}});e.closest(".productsFound").classList.remove("show"),o.innerHTML="",o&&o.append(t(s))})};return{search:e=>{e.addEventListener("keyup",t=>{const r=document.querySelector(".productsFound");if(!e.value.length)return r.classList.remove("show");e.value&&e.value.length>3&&((e,t,o)=>{void 0===window.delayed_methods&&(window.delayed_methods={}),delayed_methods[e]=Date.now();var n=delayed_methods[e];setTimeout(function(){delayed_methods[e]==n&&(console.log(arguments),delayed_methods[e]="",t())},o||500)})("check date parallel",async()=>{try{const t=e.value.normalize("NFD").replace(/[\u0300-\u036f]/g,""),r=await n({url:`/api/product_search/${t}`,method:"GET",headers:{"content-type":"application/json"}});if(r.length)return(e=>{const t=document.querySelector(".productsFound");t.classList.add("show"),t.innerHTML="",e.map(e=>{const n=o(e);t.append(n)})})(r)}catch(e){console.log(e)}})})}}})(),inputSearch=document.querySelector(".productParamSearch");inputSearch&&searching.search(inputSearch);const createProductBySearch=e=>new Promise((t,o)=>{const{name:n,code:r,image:a,options:s,id:c}=e,d=document.createElement("div");let i="";s.length&&s.forEach(e=>{const{id:t,option:o}=e,n=o.customization?`(${o.customization.name})`:"";i+=`\n            <tr class="text-left optionProduct">\n               <th scope="row" class="px-1 productOptionName">\n                  ${o.name} ${n}\n               </th>\n               \n               <td>${o.price}</td>\n               <td class="text-right px-1 productRemoveOption">\n                  <a href="#" data-id="${t}">\n                  <i class="fas fa-trash-alt"></i>\n                  </a>\n               </td>\n            </tr>\n            `}),d.classList.add("col-4","productItem","my-2"),d.innerHTML=`\n      <div class="card border-primary mb-3 cardProduct item" data-id="${c}">\n         <div class="card-header text-center searchProductName">\n            ${n}\n            <button type="button" class="btn btn-danger btn-sm productDestroy" data-id="${c}">\n               <i class="fas fa-trash-alt"></i>\n            </button>\n         </div>\n   \n         <div class="card-body text-primary searchProductOptionsBody text-center px-1">\n            <table class="table table-hover searchProductOptions mb-0">\n               <thead>\n                  <tr>\n                     <th scope="col" class="text-left px-1">Option</th>\n                     <th scope="col">Preço</th>\n                     <th scope="col" class="text-right px-1">Action</th>\n                  </tr>\n               </thead>\n   \n               <tbody> ${i} </tbody>\n            </table>\n            \x3c!-- TABLE // --\x3e\n         </div>\n      </div>\n      `;const l=d.querySelectorAll(".productRemoveOption > a");Array.from(l).forEach(e=>{actionRemoveOption(e)});const u=d.querySelector(".productDestroy");return product.destroy(u),t(d)}),searchProduct=e=>{update(1,"dark"),fetch(`/api/product_search/${e}`,{method:"GET",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{update(()=>e.forEach(e=>(document.querySelector(".listProduct").innerHTML="",createProductBySearch(e).then(e=>document.querySelector(".listProduct").append(e)))),"dark")}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0}))},indexProducts=()=>{update(1,"dark"),fetch("/api/product",{method:"GET",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{update(()=>e.forEach(e=>(document.querySelector(".listProduct").innerHTML="",createProductBySearch(e).then(e=>document.querySelector(".listProduct").append(e)))),"dark")}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0}))},btnSearchProductInternal=document.querySelector(".searchProductInternal");btnSearchProductInternal.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".productParamSearch");return t.value?(o=t.value,update(1,"dark"),void fetch(`/api/product_search/${o}`,{method:"GET",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{update(()=>e.forEach(e=>(document.querySelector(".listProduct").innerHTML="",createProductBySearch(e).then(e=>document.querySelector(".listProduct").append(e)))),"dark")}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0}))):(update(1,"dark"),void fetch("/api/product",{method:"GET",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{update(()=>e.forEach(e=>(document.querySelector(".listProduct").innerHTML="",createProductBySearch(e).then(e=>document.querySelector(".listProduct").append(e)))),"dark")}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0})));var o});const internalRequest=e=>new Promise((t,o)=>{fetch(`/api/${productResource}/${e}`,{method:"GET",headers:{"content-type":"application/json"}}).then(e=>e.json()).then(e=>{if(!e)return o("Não há produtos");const{name:t,code:n,image:r}=e})}),getVtexProduct=e=>new Promise((t,o)=>{if(!e.value)return o("Informe o sku do produto");const n=`https://sistema.moveispracasa.com.br/api/admin/products/${e.value}`;new Headers({Host:"*"});fetch(n,{method:"GET",headers:{"content-type":"application/json",accept:"application/json"}}).then(e=>e.json()).then(e=>{const{product:n}=e;if(!n)return o("Produto não encontrado");const{isActiveOnVtex:r}=n;if(!r)return o("Este produto está inativo na Vtex");const{product_name:a,id:s,productName:c,productId:d}=n.vtexData;let i;if(!(i=n.vtexData.itemMetadata?n.vtexData.itemMetadata.items:n.vtexData.items).length)return o("Não há itens");const l={name:a||c,id:s||d};if(n.vtexData.items.length&&(l.skus=n.vtexData.items),i[0]&&i[0].MainImage){const{MainImage:e}=i[0];l.image=e}else{const{images:e}=i[0];if(!e)return o("Não há imagem no produto");l.image=e[0].imageUrl}return t(l)}).catch(e=>o(e))}),putValues=e=>{const{name:t,code:o,image:n}=e;document.querySelector(".nameProduct").value=t,document.querySelector(".codeProduct").value=o,document.querySelector(".productNameInsert").innerHTML=t,document.querySelector(".productCodeInsert b").innerHTML=`Código do produto: ${o}`,document.querySelector(".productImageInsert").setAttribute("src",n)},btnSearchProduct=document.querySelector(".btnGetProductVtex");btnSearchProduct.addEventListener("click",e=>{e.preventDefault(),custom.handleResetForm();let t=document.querySelector(".skuProduct");const o=btnSearchProduct.innerHTML;btnSearchProduct.innerHTML="",btnSearchProduct.append(spinner("ligth","small")),getVtexProduct(t).then(e=>{console.log(e);const{name:t,id:n,image:r,skus:a}=e;if(a&&a.length>1){const e=document.querySelector(".subProducts");e&&(e.innerHTML=""),a.map(o=>{const n=document.createElement("div");n.classList.add("col-md-2","mt-3"),n.innerHTML=`\n                     <div class="card">\n                        <img class="card-img-top" src="${o.images[0].imageUrl}" alt="Card image cap">\n                        <div class="card-body text-center" style="border-top: 1px solid rgba(0,0,0,.125)">\n                           <h6 class="card-title">${o.name}</h6>\n                        </div>\n                     </div>\n                     `,document.querySelector(".informationProduct").append(custom.handleChildForm({id:o.id||o.itemId,name:o.name,nameProduct:t})),e&&e.append(n)})}return document.querySelector(".resultProduct").classList.add("full"),btnSearchProduct.innerHTML=o,putValues({name:t,code:n,image:r})}).catch(e=>Swal.fire({title:e,icon:"error",showCloseButton:!0}))});const productResource="product";let optionsProduct=[];const product=(()=>{return{customInsert:function(e){e.addEventListener("change",function(t){if(t.preventDefault(),!0!==e.checked)return custom.removeCustom(e.value);custom.selectCustom(e.value)})},create:e=>{e.addEventListener("submit",t=>{if(t.preventDefault(),document.querySelector(".nameProduct"),document.querySelector(".codeProduct"),document.querySelector(".descriptionProduct"),document.querySelector(".imageProduct"),e.checkValidity()){const t=[...e.elements],o={children:[]};t.map(e=>{if("BUTTON"!=e.tagName){const t=e.getAttribute("id");e.classList.contains("nameProduct")&&(o.name=e.value),e.classList.contains("codeProduct")&&(o.code=e.value),e.classList.contains("descriptionProduct")&&(o.description=e.value),e.classList.contains("imageProduct")&&(o.image=e.value),t&&-1!==t.indexOf("descriptionChildren")&&o.children.push({description:e.value,name:e.closest("div").querySelector('input[id*="nameChildren"]').value,code:e.closest("div").querySelector('input[id*="codeChildren"]').value,image:e.closest(".form-row").querySelector('input[id*="imageChildren"]').value})}});const n=custom.getExcludes(),{name:r,description:a,code:s,image:c,children:d}=o;return(e=>{const{name:t,code:o,description:n,image:r,options:a,excludes:s,children:c}=e;update(1,"dark"),fetch(`/api/${productResource}`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:t,code:o,description:n,image:r,options:a,excludes:s,children:c})}).then(e=>e.json()).then(e=>{update(()=>{if(e.error)return Swal.fire({title:e.error,icon:"warning",showCloseButton:!0});optionsProduct=[],document.querySelector(".nameProduct").value="",document.querySelector(".codeProduct").value="",document.querySelector(".descriptionProduct").value="",document.querySelector(".imageProduct").value="",document.querySelector(".skuProduct").value="",document.querySelector(".resultProduct").classList.remove("full");const t=document.querySelectorAll(".formInsertProduct .form-row"),o=document.querySelectorAll(".listCustomByType .show"),n=document.querySelectorAll(".listOptionstoSelect .selected");return o&&Array.from(o).forEach(e=>e.classList.remove("show")),n&&Array.from(n).forEach(e=>e.classList.remove("selected")),Array.from(t).forEach(e=>e.remove()),"object"==typeof e?Swal.fire({title:`Produto ${e[0].name} cadastrado`,icon:"success",showCloseButton:!0}):Swal.fire({title:`Produto ${e.name} cadastrado`,icon:"success",showCloseButton:!0})},"dark")}).catch(e=>{update(()=>Swal.fire({title:"Erro ao inserir novo produto",icon:"error",showCloseButton:!0}),"dark")})})({name:r,code:parseFloat(s),description:a,image:c,options:n,excludes:n,children:d})}})},destroy:e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.dataset.id;return(e=>new Promise((t,o)=>{update(1,"dark"),fetch(`/api/product/${e}`,{method:"DELETE"}).then(e=>e.ok?t("Produto excluído com sucesso!"):o(new Error("HTTP status "+e.status))).catch(e=>o(e))}))(o).then(e=>{update(()=>(document.querySelector(`.productDestroy[data-id="${o}"]`).closest(".productItem").remove(),Swal.fire({title:e,icon:"success",showCloseButton:!0})),"dark")}).catch(e=>{update(()=>(console.log(e),Swal.fire({title:"Erro ao excluir produto!",icon:"warning",showCloseButton:!0})),"dark")})})}}})(),allCheckCustom=[...document.querySelectorAll("#selectAllCustom")];allCheckCustom&&allCheckCustom.map(product.customInsert),$("#modalProductOptions").on("hidden.bs.modal",function(e){$("#productCustons").modal("show")});const destroyProductOption=e=>{update(1,"dark"),fetch(`/api/product_option/${e}`,{method:"DELETE"}).then(e=>e.json()).then(t=>{update(()=>{return document.querySelector(`.productRemoveOption a[data-id="${e}"]`).closest(".optionProduct").remove(),Swal.fire({title:"Customização removida com sucesso!",icon:"success",showCloseButton:!0})},"dark")})},actionRemoveOption=e=>{e.addEventListener("click",t=>{t.preventDefault();const o=e.dataset.id;destroyProductOption(o)})},linkRemoveOption=document.querySelectorAll(".productRemoveOption > a");Array.from(linkRemoveOption).forEach(e=>{actionRemoveOption(e)});const btnsDestroyProduct=document.querySelectorAll(".productDestroy");Array.from(btnsDestroyProduct).forEach(e=>product.destroy(e));const clickOption=e=>{e.addEventListener("click",function(t){const o=e.querySelector(".productOptionName").innerHTML,n=e.dataset.id,r=e.dataset.custom,a=e.dataset.customName,s=e.querySelector(".card-body img").getAttribute("src");if(e.classList.add("active"),!document.querySelector(`.optionsSelected div[data-option="${n}"]`))return optionInsert({name:o,id:n,custom:r,custom_name:a,image:s}),optionsProduct.push(parseInt(n))})},optionInsert=e=>{const{id:t,name:o,custom:n,custom_name:r,image:a}=e,s=document.createElement("div");s.classList.add("col-3","optionSelect"),s.dataset.option=t,s.innerHTML=`<div class="card">\n      <div class="card-header text-center productCustomName" data-custom="${n}">\n         <button type="button" class="btn btn-danger btn-sm optionSelectDel" data-id="${t}">\n            <i class="fas fa-trash-alt" aria-hidden="true"></i>\n         </button>\n         ${r}\n      </div>\n      <div class="card-body productOptionName text-center">\n         <p>${o}</p>\n         <div class="row">\n            <div class="col-12">\n               <img src="${a}" alt="..." width="100" class="img-thumbnail">\n            </div>\n         </div>\n      </div>\n   </div>`;const c=s.querySelector(".optionSelectDel");return c.addEventListener("click",e=>{const t=c.dataset.id;return optionsProduct.splice(optionsProduct.indexOf(parseInt(t)),1),c.closest(".optionSelect").remove()}),document.querySelector(".optionsSelected").append(s)},optionsCreate=e=>{const{id:t,name:o,image:n,custom:r,custom_name:a}=e,s=document.querySelector(".modalProductOptionsContainer"),c=document.createElement("div");return c.classList.add("col-3"),c.dataset.custom=r,c.dataset.customName=a,c.dataset.id=t,c.innerHTML=`\n   <div class="card productOption">\n      <div class="card-header productOptionName">${o}</div>\n      <div class="card-body">\n      <img src="${n}" alt="..." width="150" class="img-thumbnail">\n      </div>\n   </div>\n   `,clickOption(c),s.append(c)},getOptions=e=>{document.querySelector(".modalProductOptionsContainer").innerHTML="",document.querySelector(".modalProductOptionsContainer").append(spinner()),fetch(`/api/option?custom=${e}`,{method:"GET"}).then(e=>e.json()).then(e=>{update(()=>{const{options:t}=e;return document.querySelector(".modalProductOptionsContainer").innerHTML="",t.forEach(t=>optionsCreate({id:t.id,custom:t.customization_id,custom_name:e.name,name:t.name,image:t.image}))},"dark")})},clickCustom=e=>{e.addEventListener("click",function(t){t.preventDefault();const o=e.closest(".col-4").dataset.custom;return $("#productCustons").on("hidden.bs.modal",function(e){$("#modalProductOptions").modal("show"),$(this).off("hidden.bs.modal")}),$("#modalProductOptions").on("hidden.bs.modal",function(e){$("#productCustons").modal("show")}),getOptions(o)})},customCreate=e=>{const{id:t,name:o,custom:n,custom_name:r}=e,a=document.createElement("div");return a.classList.add("col-3"),a.dataset.option=t,a.innerHTML=`<div class="card">\n      <div class="card-header productCustomName" data-custom="${n}">${r}</div>\n      <div class="card-body productOptionName">\n      ${o}\n      </div>\n   </div>`,document.querySelector(".optionsSelected").append(a)},formInsertProduct=document.querySelector(".formInsertProduct"),productOption=document.querySelectorAll(".productOption .card");Array.from(productOption).forEach(e=>{clickCustom(e)}),formInsertProduct&&product.create(formInsertProduct);const typeResource="type";let type=(()=>{const e=e=>{const t=document.querySelector(".actionConfirm"),o=document.querySelector(".aceptAction");t.value="TypeDestroy",o.dataset.id=parseInt(e.getAttribute("data-delete").replace("#type-","")),$(".modal.types").on("hidden.bs.modal",function(e){$(".modalActionConfirm").modal("show"),$(this).off("hidden.bs.modal")}),$(".modal.types").modal("hide"),o.addEventListener("click",n=>{if("TypeDestroy"==t.value){const t=o.dataset.id;$(".modalActionConfirm").on("hidden.bs.modal",function(e){$(".modal.types").modal("show"),$(this).off("hidden.bs.modal")}),update(1,"dark"),fetch(`/api/type/${t}`,{method:"DELETE"}).then(t=>{update(2,"dark"),t.json().then(t=>update(()=>e.closest(".card").remove(),"dark")).catch(e=>console.log(e))}).catch(e=>{console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})},"dark")})}})},t=e=>{const t=e.getAttribute("type-id");document.querySelector(".typeCustom").value=t;const o=e.closest(".card-type").querySelector(".card-title");return document.querySelector(".btn-modal-types").classList.remove("btn-primary"),document.querySelector(".btn-modal-types").classList.add("btn-success"),document.querySelector(".btn-modal-types").innerHTML=o.innerHTML};return{insertTab:e=>{const t=document.createElement("a"),{id:o,name:n}=e;t.classList.add("list-group-item","list-group-item-action"),t.setAttribute("id",`list-type-${o}-list`),t.setAttribute("role","tab"),t.setAttribute("aria-selected","false"),t.setAttribute("aria-controls",`list-type-${o}`),t.setAttribute("href",`#list-type-${o}`),t.dataset.toggle="list",t.innerHTML=n;const r=document.createElement("div");r.classList.add("tab-pane","fade"),r.setAttribute("id",`list-type-${o}`),r.setAttribute("role","tabpanel"),r.setAttribute("aria-labelledby",`list-type-${o}-list`);const a=()=>{const e=document.createElement("div");return e.classList.add("row"),e.innerHTML=`<div class="col-12">\n               <nav aria-label="..." class="paginate-type-${o}" data-resource="type">\n                  <ul class="pagination">\n                  <li class="page-item disabled">\n                     <span class="page-link">Previous</span>\n                  </li>\n                  <li class="page-item active" aria-current="page">\n                     <span class="page-link">\n                        1\n                        <span class="sr-only">(current)</span>\n                     </span>\n                  </li>\n                  <li class="page-item">\n                     <a class="page-link" href="#">Next</a>\n                  </li>\n                  </ul>\n               </nav>\n            </div> \x3c!-- Paginação // --\x3e`,e},s=document.createElement("div");return s.classList.add("row",`container-type-${o}`),document.querySelector(".tabContentTypes").append(r),r.append(a()),r.append(s),r.append(a()),document.querySelector(".tabTypes").append(t)},removeTab:e=>{document.querySelector(`#list-type-${e}-list`).remove(),document.querySelector(`#list-type-${e}`).remove()},create:o=>{if(!o.value)return alert("Informe o nome do tipo de customização");update(1,"dark"),fetch("/api/type",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:o.value})}).then(n=>{update(2,"dark"),n.json().then(n=>{const r=(o=>{const{id:n,name:r}=o,a=document.createElement("div");a.classList.add("card","mb-3","card-type"),a.id=`type-${n}`,a.style.flex="0 0 calc(33.333333% - 10px)",a.style.margin="0 5px",a.innerHTML=`\n         <div class="card-body text-center">\n            <h6 class="card-title mb-0">${r}</h6>\n         </div>\n         <div class="types-hover">\n            <button type="button" class="btn btn-danger del-type" data-delete="#type-${n}">\n            <i class="fas fa-trash-alt"></i>\n            </button>\n            <button type="button" class="btn btn-success select-type" data-dismiss="modal" type-id="${n}" data-select="#type-${n}">\n            <i class="fas fa-check"></i>\n            </button>\n         </div>`,a.querySelector(".select-type").addEventListener("click",e=>{e.preventDefault(),t(a.querySelector(".select-type"))});const s=a.querySelector(".del-type");return s.addEventListener("click",t=>{t.preventDefault(),e(s)}),a})({id:n.id,name:n.name}),a=document.querySelector(".typesContainer");return o.value="",update(()=>a.prepend(r),"dark")}).catch(e=>console.log(e))}).catch(e=>{console.log(e)})},destroy:e,select:t}})();const btnInsertType=document.querySelector(".insertType");btnInsertType.addEventListener("click",e=>(e.preventDefault(),type.create(document.querySelector(".typeName"))));const btnDeleteType=document.querySelectorAll(".del-type");Array.from(btnDeleteType).forEach(e=>{e.addEventListener("click",t=>(t.preventDefault(),type.destroy(e)))});let btnSelect=document.querySelectorAll(".select-type");Array.from(btnSelect).forEach(e=>{e.addEventListener("click",function(t){return type.select(e)})});const customUpdate=e=>{const{id:t,name:o,description:n,type_id:r}=e;update(1,"dark"),fetch(`/api/custon/${t}`,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({name:o,description:n,type_id:r})}).then(e=>{update(()=>(console.log(e),$("#modalUnrelated").modal("hide")),"dark")}).catch(e=>(console.log(e),update(()=>{Swal.fire({title:"Tivemos um erro de sistema",icon:"error",showCloseButton:!0})})))},editCustom=()=>{const e=document.querySelectorAll(".unrelatedCustom");document.querySelector(".editCustomForm").addEventListener("submit",e=>{e.preventDefault();const t={id:document.querySelector(".unrelatedCustomId").value,name:document.querySelector("#ulName").value,description:document.querySelector("#ulDescription").value,type_id:parseInt(document.querySelector("#ulTypeId").value)};return customUpdate(t)}),Array.from(e).forEach(e=>{e.addEventListener("click",t=>{const o=e.dataset.id,n=e.querySelector(".unrelatedName").innerHTML,r=e.querySelector(".unrelatedDescription").innerHTML;document.querySelector(".unrelatedCustomId").value=o,document.querySelector("#ulName").value=n,document.querySelector("#ulDescription").value=r,$("#modalUnrelated").modal("show")})})};editCustom();